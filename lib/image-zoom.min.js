!function t(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("image-zoom",[],n):"object"==typeof exports?exports["image-zoom"]=n():e["image-zoom"]=n()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function e(){return t.default}:function e(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e,n){!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return function(e){return("undefined"==typeof e?"undefined":E(e))===t}}function e(t){return function(e){return e.tagName===t}}function n(t,e){for(var n=[];t&&t!==document;t=t.parentNode)e?e(t)&&n.push(t):n.push(t);return n}function o(){return e("IMG")===!1}function i(t,e){if(t){var n=new Image;n.onload=function(){e&&e(n)},n.src=t}}function r(t,e){var n=null;t.hasAttribute("data-original")?n=t.getAttribute("data-original"):M(t.parentNode)&&(n=t.parentNode.getAttribute("href")),e(n)}function s(t){var e=H.transitionProp,n=H.transformProp,o=void 0;t.transition&&(o=t.transition,delete t.transition,t[e]=o),t.transform&&(o=t.transform,delete t.transform,t[n]=o)}function a(t){var e={},n=["webkitTransition","transition","mozTransition"],o=["webkitTransform","transform","mozTransform"],i={transition:"transitionend",mozTransition:"transitionend",webkitTransition:"webkitTransitionEnd"};return n.some(function(n){if(void 0!==t.style[n])return e.transitionProp=n,e.transEndEvent=i[n],!0}),o.some(function(n){if(void 0!==t.style[n])return e.transformProp=n,e.transformCssProp=n.replace(/(.*)Transform/,"-$1-transform"),!0}),e}function l(t){return function(e){return e/t}}function u(t,e,n,o){o?t.addEventListener(e,n[e],{passive:!1}):t.removeEventListener(e,n[e],{passive:!1})}function c(){var t=Math.min(L.clientWidth,window.innerWidth),e=Math.min(L.clientHeight,window.innerHeight);return{x:D(t),y:D(e)}}function h(t,e,n){["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"].forEach(function(o){u(t,o,e,n)})}function f(t,e,n){s(e);var o=t.style,i={};for(var r in e)n&&(i[r]=o[r]||""),o[r]=e[r];return i}function v(t,e){var n=Object.getOwnPropertyNames(Object.getPrototypeOf(t));n.forEach(function(n){t[n]=t[n].bind(e)})}function d(t){return"hidden"===getComputedStyle(t).overflow}function p(t){if(N.map.has(t))return N.map.get(t);var e=n(t.parentNode,d);return N.map.set(t,e),e}function y(t){p(t).forEach(function(t){N.style.has(t)?f(t,{overflow:"visible"}):N.style.set(t,f(t,{overflow:"visible"},!0))})}function m(t){N.map.has(t)&&N.map.get(t).forEach(function(t){f(t,N.style.get(t))})}function b(t){return 0!==t.button}function g(t){var e=t.key||t.code;return"Escape"===e||27===t.keyCode}function w(t){return t.targetTouches.length>0}function k(t,e,n){for(var o=t.length,i=t[0],r=o>1,s=e,a=t.length,l=0,u=0,c={x:i.clientX,y:i.clientY},h={x:i.clientX,y:i.clientY};a--;){var f=t[a],v=[f.clientX,f.clientY],d=v[0],p=v[1];l+=d,u+=p,r&&(d<c.x?c.x=d:d>h.x&&(h.x=d),p<c.y?c.y=p:p>h.y&&(h.y=p))}if(r){var y=h.x-c.x,m=h.y-c.y;s=y>m?y/window.innerWidth*F:m/window.innerHeight*F}n(l/o,u/o,s)}function x(t){var e=c(),n={x:t.left+D(t.width),y:t.top+D(t.height)};return{x:e.x-n.x,y:e.y-n.y}}function O(t,e,n){if(n)return{x:n.width/t.width,y:n.height/t.height};var o=D(t.width),i=D(t.height),r=c(),s={x:r.x-o,y:r.y-i},a=s.x/o,l=s.y/i,u=e+Math.min(a,l);return{x:u,y:u}}var E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},P=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},C=function t(e,n,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,o)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(o)},z=function t(e,n,o,i){var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var s=Object.getPrototypeOf(e);null!==s&&t(s,n,o,i)}else if("value"in r&&r.writable)r.value=o;else{var a=r.set;void 0!==a&&a.call(i,o)}return o},j=document.body,L=document.documentElement,B=t("string"),M=e("A"),_="WebkitAppearance"in L.style?"-webkit-":"",H=a(document.createElement("div")),I=H.transformCssProp,A=H.transEndEvent,D=l(2),G={default:"auto",zoomIn:_+"zoom-in",zoomOut:_+"zoom-out",grab:_+"grab",move:"move"},N={map:new Map,style:new Map,disable:y,enable:m},R=200,F=2,W=function(){function t(e){T(this,t),v(this,e)}return P(t,[{key:"click",value:function t(e){e.preventDefault(),this.shown?this.released?this.close():this.release():this.open(e.currentTarget)}},{key:"scroll",value:function t(){var e=window.pageYOffset||(L||j.parentNode||j).scrollTop;null===this.lastScrollPosition&&(this.lastScrollPosition=e);var n=this.lastScrollPosition-e;Math.abs(n)>=this.options.scrollThreshold&&(this.lastScrollPosition=null,this.close())}},{key:"keydown",value:function t(e){var n=this;g(e)&&(this.released?this.close():this.release(function(){return n.close()}))}},{key:"mousedown",value:function t(e){var n=this;b(e)||(e.preventDefault(),this.pressTimer=setTimeout(function(){n.grab(e.clientX,e.clientY)},R))}},{key:"mousemove",value:function t(e){this.released||this.move(e.clientX,e.clientY)}},{key:"mouseup",value:function t(e){b(e)||(clearTimeout(this.pressTimer),this.released?this.close():this.release())}},{key:"touchstart",value:function t(e){var n=this;e.preventDefault(),this.pressTimer=setTimeout(function(){k(e.touches,n.options.scaleExtra,function(t,e,o){n.grab(t,e,o)})},R)}},{key:"touchmove",value:function t(e){var n=this;this.released||k(e.touches,this.options.scaleExtra,function(t,e,o){n.move(t,e,o)})}},{key:"touchend",value:function t(e){w(e)||(clearTimeout(this.pressTimer),this.released?this.close():this.release())}}]),t}(),Y=function(){function t(e,n){T(this,t),this.el=e,this.instance=n,this.parent=document.body}return P(t,[{key:"init",value:function t(e){var n=this;f(this.el,{zIndex:998,backgroundColor:e.bgColor,position:"fixed",top:0,left:0,right:0,bottom:0,opacity:0,transition:"opacity\n        "+e.transitionDuration+"s\n        "+e.transitionTimingFunction}),this.el.addEventListener("click",function(){return n.instance.close()})}},{key:"updateStyle",value:function t(e){f(this.el,{backgroundColor:e.bgColor,transition:"opacity\n        "+e.transitionDuration+"s\n        "+e.transitionTimingFunction})}},{key:"insert",value:function t(){this.parent.appendChild(this.el)}},{key:"remove",value:function t(){this.parent.removeChild(this.el)}},{key:"show",value:function t(){var e=this;setTimeout(function(){return e.el.style.opacity=e.instance.options.bgOpacity},30)}},{key:"hide",value:function t(){this.el.style.opacity=0}}]),t}(),X=function(){function t(e,n){T(this,t),this.el=e,this.instance=n,this.translate=null,this.scale=null,this.srcThumbnail=this.el.getAttribute("src"),this.style={open:null,close:null}}return P(t,[{key:"zoomIn",value:function t(){var e=this.instance.options,n=this.el.getBoundingClientRect();N.disable(this.el),this.translate=x(n),this.scale=O(n,e.scaleBase,e.customSize),this.el.offsetWidth,this.style.open={position:"relative",zIndex:999,cursor:e.enableGrab?G.grab:G.zoomOut,transition:I+"\n        "+e.transitionDuration+"s\n        "+e.transitionTimingFunction,transform:"translate("+this.translate.x+"px, "+this.translate.y+"px)\n        scale("+this.scale.x+","+this.scale.y+")",width:n.width+"px",height:n.height+"px"},this.style.close=f(this.el,this.style.open,!0)}},{key:"zoomOut",value:function t(){N.enable(this.el),this.el.offsetWidth,f(this.el,{transform:"none"})}},{key:"grab",value:function t(e,n,o){var i=c(),r=i.x-e,s=i.y-n;f(this.el,{cursor:G.move,transform:"translate(\n        "+(this.translate.x+r)+"px, "+(this.translate.y+s)+"px)\n        scale("+(this.scale.x+o)+","+(this.scale.y+o)+")"})}},{key:"move",value:function t(e,n,o){var i=c(),r=i.x-e,s=i.y-n;f(this.el,{transition:I,transform:"translate(\n        "+(this.translate.x+r)+"px, "+(this.translate.y+s)+"px)\n        scale("+(this.scale.x+o)+","+(this.scale.y+o)+")"})}},{key:"restoreCloseStyle",value:function t(){f(this.el,this.style.close)}},{key:"restoreOpenStyle",value:function t(){f(this.el,this.style.open)}},{key:"upgradeSource",value:function t(e){var n=this;if(e){var o=this.el.parentNode,i=this.el.cloneNode(!1);i.setAttribute("src",e),i.style.position="fixed",i.style.visibility="hidden",o.appendChild(i),setTimeout(function(){n.el.setAttribute("src",e),o.removeChild(i)},100)}}},{key:"downgradeSource",value:function t(e){e&&this.el.setAttribute("src",this.srcThumbnail)}}]),t}(),q={defaultZoomable:'img[data-action="zoom"]',enableGrab:!0,preloadImage:!0,transitionDuration:.4,transitionTimingFunction:"cubic-bezier(0.4, 0, 0, 1)",bgColor:"rgb(255, 255, 255)",bgOpacity:1,scaleBase:1,scaleExtra:.5,scrollThreshold:40,customSize:null,onOpen:null,onClose:null,onRelease:null,onBeforeOpen:null,onBeforeClose:null,onBeforeGrab:null,onBeforeMove:null,onBeforeRelease:null},Z=function(){function t(e){T(this,t),this.target=null,this.overlay=new Y(document.createElement("div"),this),this.eventHandler=new W(this),this.body=document.body,this.shown=!1,this.lock=!1,this.released=!0,this.lastScrollPosition=null,this.pressTimer=null,this.options=S({},q),this.config(e),this.listen(this.options.defaultZoomable),this.overlay.init(this.options)}return P(t,[{key:"listen",value:function t(e){if(B(e)){for(var n=document.querySelectorAll(e),s=n.length;s--;)this.listen(n[s]);return this}if(!o(e))return e.style.cursor=G.zoomIn,e.addEventListener("click",this.eventHandler.click,{passive:!1}),this.options.preloadImage&&r(e,i),this}},{key:"config",value:function t(e){return e?(S(this.options,e),this.overlay.updateStyle(this.options),this):this.options}},{key:"open",value:function t(e){var n=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.onOpen;if(!this.shown&&!this.lock){var a=B(e)?document.querySelector(e):e;if(!o(a)){this.options.onBeforeOpen&&this.options.onBeforeOpen(a),this.options.preloadImage||r(a,i),this.target=new X(a,this),this.shown=!0,this.lock=!0,this.target.zoomIn(),this.overlay.insert(),this.overlay.show(),document.addEventListener("scroll",this.eventHandler.scroll),document.addEventListener("keydown",this.eventHandler.keydown);var l=function t(){a.removeEventListener(A,t),n.lock=!1,r(a,function(t){return n.target.upgradeSource(t)}),n.options.enableGrab&&h(document,n.eventHandler,!0),s&&s(a)};return a.addEventListener(A,l),this}}}},{key:"close",value:function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onClose;if(this.shown&&!this.lock){var o=this.target.el;this.options.onBeforeClose&&this.options.onBeforeClose(o),this.lock=!0,this.body.style.cursor=G.default,this.overlay.hide(),this.target.zoomOut(),document.removeEventListener("scroll",this.eventHandler.scroll),document.removeEventListener("keydown",this.eventHandler.keydown);var i=function t(){o.removeEventListener(A,t),e.shown=!1,e.lock=!1,r(o,function(t){return e.target.downgradeSource(t)}),e.options.enableGrab&&h(document,e.eventHandler,!1),e.target.restoreCloseStyle(),e.overlay.remove(),n&&n(o)};return o.addEventListener(A,i),this}}},{key:"grab",value:function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,i=arguments[3];if(this.shown&&!this.lock){var r=this.target.el;this.options.onBeforeGrab&&this.options.onBeforeGrab(r),this.released=!1,this.target.grab(e,n,o);var s=function t(){r.removeEventListener(A,t),i&&i(r)};r.addEventListener(A,s)}}},{key:"move",value:function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.scaleExtra,i=arguments[3];if(this.shown&&!this.lock){var r=this.target.el;this.options.onBeforeMove&&this.options.onBeforeMove(r),this.released=!1,this.target.move(e,n,o),this.body.style.cursor=G.move;var s=function t(){r.removeEventListener(A,t),i&&i(r)};r.addEventListener(A,s)}}},{key:"release",value:function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.onRelease;if(this.shown&&!this.lock){var o=this.target.el;this.options.onBeforeRelease&&this.options.onBeforeRelease(o),this.lock=!0,this.target.restoreOpenStyle(),this.body.style.cursor=G.default;var i=function t(){o.removeEventListener(A,t),e.lock=!1,e.released=!0,n&&n(o)};return o.addEventListener(A,i),this}}}]),t}();return document.addEventListener("DOMContentLoaded",function(){new Z}),Z})},function(t,e,n){var o,i,r;!function(s,a){var l;i=[e,n(0)],o=a,r="function"==typeof o?o.apply(e,i):o,!(void 0!==r&&(t.exports=r))}(this,function(t,e){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(e),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),l=function(t){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return r(e,t),a(e,[{key:"init",value:function t(){this.zooming=new s.default(this.options),this.zooming.listen(this.node)}}]),e}(base.features.Feature);l.defaultOptions={enableGrab:!1,bgOpacity:.4,bgColor:"rgb(0, 0, 0)",scaleBase:.9},t.default=l})}])});
//# sourceMappingURL=image-zoom.min.js.map